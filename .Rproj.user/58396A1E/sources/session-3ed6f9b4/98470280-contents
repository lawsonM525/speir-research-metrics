separate <- function(partial){
  
  # Identify columns starting with 'q' or 'j'
  q_columns <- grep("^q.*[abc]$", names(partial), value = TRUE)
  j_columns <- grep("^j.*[abc]$", names(partial), value = TRUE)
  
  # Convert those columns to numeric
  partial[q_columns] <- lapply(partial[q_columns], 
                               function(x) as.numeric(as.character(x)))
  partial[j_columns] <- lapply(partial[j_columns], 
                               function(x) as.numeric(as.character(x)))
  partial$SC0 <- as.numeric(as.character(partial$SC0))
  
  # Now calculate the row sums
  partial$mcq_points <- rowSums(partial[q_columns], na.rm = TRUE)
  partial$justification_points <- rowSums(partial[j_columns], na.rm = TRUE)
  
  
  # Return new df
  return(partial)
  
  # partial$j_gain <- partial$mcq_points - partial$justification_points
  # ^ wrong calculation
  # partial$j_gain <- ((partial$SC0 - partial$mcq_points)/mcq_points) * 100
  # ^ New calculation
  
}